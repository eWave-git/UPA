<!-- Page header -->
<div class="page-header d-print-none">
    <div class="container-xl">
        <div class="row g-2 align-items-center">
            <div class="col">
                <h2 class="page-title">
                    알람설정
                </h2>
            </div>

        </div>
    </div>
</div>
<!-- Page body -->
<div class="page-body">
    <div class="container-xl">
        <div class="row row-cards">
            <div class="col-12">
                <form class="card" method="post" action="{{action}}" >
                    <div class="card-header">
                        <h3 class="card-title">알람 등록</h3>
                    </div>
                    <div class="card-body">
                        <div class="mb-3 row">
                            <label class="col-2 col-form-label required">장치</label>
                            <div class="col">
                                <select class="form-select" name="device" id="device">
                                    {{device_options}}
                                </select>
                            </div>
                        </div>
                        <div class="mb-3 row">
                            <label class="col-2 col-form-label required">데이터</label>
                            <div class="col">
                                <select class="form-select" name="board" id="board">
                                    {{board_options}}
                                </select>
                            </div>
                        </div>

                        <div class="mb-3 row">
                            <label class="col-2 col-form-label required">알람설정범위</label>
                            <div class="col">
                                <select class="form-select" name="alarm_range" id="alarm_range">
                                    <option value="between">적정범위</option>
                                    <option value="up">이상</option>
                                    <option value="down">이하</option>
                                </select>
                            </div>
                        </div>
                        <div class="mb-3 row" id="between_row">
                            <label class="col-2 col-form-label required">정상범위</label>
                            <div class="col">
                                <div class="row">
                                    <input type="text" id="between_min" name="between_min" class="form-control" placeholder="" value="{{min}}" style="width: 150px;">&nbsp;~&nbsp;
                                    <input type="text" id="between_max" name="between_max" class="form-control" placeholder="" value="{{max}}" style="width: 150px;">
                                </div>
                            </div>
                        </div>
                        <div class="mb-3 row" id="up_row" style="display: none;">
                            <label class="col-2 col-form-label required">이상</label>
                            <div class="col">
                                <div class="row">
                                    <input type="text" id="up_max" name="up_max" class="form-control" placeholder="" value="{{max}}" style="width: 150px;"> <div class="col col-form-label"> 이상</div>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3 row" id="down_row" style="display: none;">
                            <label class="col-2 col-form-label required">이하</label>
                            <div class="col">
                                <div class="row">
                                    <input type="text" id="down_min" name="down_min" class="form-control" placeholder="" value="{{min}}" style="width: 150px;"> <div class="col col-form-label"> 이하</div>
                                </div>
                            </div>
                        </div>
                        <input type="hidden" name="target_user" value="{{target_user}}">
                        <input type="hidden" name="activation" value="Y">
<!--                        <div class="mb-3 row">-->
<!--                            <label class="col-2 col-form-label required">발송 대상</label>-->
<!--                            <div class="col">-->
<!--                                <div class="form-selectgroup form-selectgroup-pills">-->
<!--                                    {{target_user}}-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                        <div class="mb-3 row">-->
<!--                            <label class="col-2 col-form-label required">활성화</label>-->
<!--                            <div class="col">-->
<!--                                <label class="form-check form-switch">-->
<!--                                    <input class="form-check-input" type="checkbox" name="activation" value="Y" {{checked}}>-->
<!--                                    <span class="form-check-label"></span>-->
<!--                                </label>-->
<!--                            </div>-->
<!--                        </div>-->
                    </div>
                    <div class="card-footer text-center">
                        <button type="submit" class="btn btn-primary">저장</button>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                        <a href="/manager/alarm_list"><button type="button" class="btn btn-secondary">목록</button></a>
                    </div>
                </form>
            </div>

        </div>
    </div>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script>
    $(function () {
        $("#alarm_range").change(function () {

            if ($(this).val() =="between") {
                $("#between_row").show()
                $("#up_row").hide()
                $("#down_row").hide()
            } else if ($(this).val() =="up") {
                $("#between_row").hide()
                $("#up_row").show()
                $("#down_row").hide()
            } else if ($(this).val() =="down") {
                $("#between_row").hide()
                $("#up_row").hide()
                $("#down_row").show()
            }

        });


        $("#device").change(function () {
            // alert($(this).val());
            $("#board").empty()
            $.ajax({
                url:'/manager/alarm_form/getBoardType',
                type:'post',
                data: {
                    device_idx:$(this).val()
                },
                dataType: "json",
                success:function(obj){
                    if (obj.success) {
                        $.each(obj.value, function (key, value) {
                            // console.log(obj.idx[key])
                            $("#board").append(
                                $("<option></option>").attr("value",value).text(obj.text[key])
                            )
                        })

                    }
                }
            })
        });
    });
</script>
